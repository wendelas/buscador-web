<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jstl/core" template="comum/template.xhtml">

	<title>Busca Livre</title>

	<ui:define name="body">
		<p:panel header="Busca Livre"
			style="margin-left: 4%; margin-right: 4%;">

			<h:panelGrid columns="2" styleClass="formClass">
				<h:panelGrid columns="5"
					columnClasses="noStyleClass, fullWidthClass, noStyleClass, alignRightClass, alignRighClass">
					<h:outputText value="Argumento:" />
					<h:inputText value="#{buscaLivreBean.consulta}" size="100"
						label="Consulta">
						<f:validateLength minimum="1" />
					</h:inputText>

					<h:outputText value="Índice:" />
					<h:selectOneMenu layout="lineDirection" label="Índice"
						value="#{buscaLivreBean.idFonteDados}">
						<c:forEach items="#{utilitarioBean.fontes}" var="fonte">
							<f:selectItem itemValue="#{fonte.id}" itemLabel="#{fonte.nome}" />
						</c:forEach>
					</h:selectOneMenu>

					<h:commandButton value="Consultar"
						action="#{buscaLivreBean.consultar}" />

				</h:panelGrid>
			</h:panelGrid>

			<p:spacer height="10px"
				rendered="#{not empty buscaLivreBean.itens or not empty buscaLivreBean.consulta}" />
			<p:separator height="2" lineType="dotted"
				rendered="#{not empty buscaLivreBean.itens or not empty buscaLivreBean.consulta}" />
			<p:spacer height="10px"
				rendered="#{not empty buscaLivreBean.itens or not empty buscaLivreBean.consulta}" />

			<p:panel
				rendered="#{empty buscaLivreBean.itens and not empty buscaLivreBean.consulta}">
				<h:outputText
					value="Nenhum documento encontrado para o argumento pesquisado" />
			</p:panel>

			<p:panel rendered="#{not empty buscaLivreBean.itens}">
				<h:panelGrid columns="1">
					<h:outputText
						value="Duração da consulta: #{buscaLivreBean.duracaoBusca} segundos. " />
					<h:outputText
						value="Quantidade de itens encontrados: #{buscaLivreBean.quantidadeDeItens}." />
				</h:panelGrid>
			</p:panel>

			<p:spacer height="10px"
				rendered="#{not empty buscaLivreBean.itens or not empty buscaLivreBean.consulta}" />

			<p:panel rendered="#{not empty buscaLivreBean.itens}">
				<p:dataTable id="tblItens" value="#{buscaLivreBean.itens}"
					var="item" rows="20">
					<p:column>
						<f:facet name="header">
							<h:outputText value="View" />
						</f:facet>
						<h:commandLink action="#{buscaLivreBean.visualizarDetalhe}">
							<f:param value="#{item}" name="scoreDoc" />
							<h:graphicImage value="imagens/view.png" />
						</h:commandLink>
					</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Conteúdo" />
						</f:facet>
						<h:outputText escape="false"
							value="#{buscaLivreBean.mostraDados(item)}" />
					</p:column>
					<f:facet name="footer">
						<p:datascroller />
					</f:facet>

				</p:dataTable>

			</p:panel>

		</p:panel>
	</ui:define>
</ui:composition>
