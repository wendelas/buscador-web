<?xml version="1.0" encoding="ISO-8859-1"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
	<rich:tab name="Serviços"
		action="#{indicadorLaboratorioRedeBean.gerarIndicadorLaboratoriosServico}"
		reRender="regiaoServico">
		<f:facet name="label">
			<h:panelGroup>
				<h:outputText value="Serviços" />
			</h:panelGroup>
		</f:facet>
		<a4j:region id="regiaoServico"
			rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorServico != null}">
			<rich:dataTable id="laboratoriosPorServicoTable"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorServico.wrappedData}"
				rows="#{globalBean.defaultPageSize}"
				value="#{indicadorLaboratorioRedeBean.laboratoriosPorServico}"
				var="laboratorioPorServico" rowKeyVar="indexServico"
				styleClass="fullWidthClass">
				<rich:column style="width:3%">
					<a4j:commandLink id="linkExibeIndicadoresServico"
						action="#{indicadorLaboratorioRedeBean.exibeIndicadorServico}"
						reRender="laboratoriosPorServicoTable, messages">
						<h:graphicImage value="/common/images/nolines_plus.gif"
							style="border: none"
							rendered="#{!laboratorioPorServico.exibeIndicadores}" />
						<h:graphicImage value="/common/images/nolines_minus.gif"
							style="border: none"
							rendered="#{laboratorioPorServico.exibeIndicadores}" />
					</a4j:commandLink>
				</rich:column>
				<rich:column style="width:9%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="UF" />
					</f:facet>
					<h:outputText value="#{laboratorioPorServico.uf}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:24%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Vínculo" />
					</f:facet>
					<h:outputText />
				</rich:column>
				<rich:column style="width:24%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Laboratório" />
					</f:facet>
					<h:outputText />
				</rich:column>
				<rich:column style="width:24%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Serviço Ofertado" />
					</f:facet>
					<h:outputText />
				</rich:column>
				<rich:column style="width:8%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Quantidade" />
					</f:facet>
					<h:outputText value="#{laboratorioPorServico.quantidade}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:8%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="%" />
					</f:facet>
					<h:outputText value="#{laboratorioPorServico.media}"
						style="font-weight: bold;">
						<f:convertNumber maxFractionDigits="2" />
					</h:outputText>
				</rich:column>
				<rich:subTable rendered="#{laboratorioPorServico.exibeIndicadores}"
					id="laboratoriosPorServicoAreaSubTable"
					rows="#{globalBean.defaultPageSize}"
					value="#{laboratorioPorServico.indicadoresUF}" var="indicadorArea"
					rowKeyVar="indexArea" styleClass="fullWidthClass">
					<rich:column style="width:3%">
						<a4j:commandLink id="linkExibeIndicadoresServicoArea"
							action="#{indicadorLaboratorioRedeBean.exibeIndicadorServicoVinculo}"
							reRender="laboratoriosPorServicoTable, messages">
							<h:graphicImage value="/common/images/nolines_plus.gif"
								style="border: none"
								rendered="#{!indicadorArea.exibeIndicadores}" />
							<h:graphicImage value="/common/images/nolines_minus.gif"
								style="border: none"
								rendered="#{indicadorArea.exibeIndicadores}" />
							<a4j:actionparam name="indiceLabArea" value="${indexArea}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabArea}" />
							<a4j:actionparam name="indiceLabServico" value="${indexServico}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabServico}" />
						</a4j:commandLink>
					</rich:column>
					<rich:column style="width:9%">
						<h:outputText />
					</rich:column>
					<rich:column style="width:24%">
						<h:outputText value="#{indicadorArea.descricaoParent}"
							style="font-weight: bold;" />
					</rich:column>
					<rich:column style="width:24%">
						<h:outputText />
					</rich:column>
					<rich:column style="width:24%">
						<h:outputText />
					</rich:column>
					<rich:column style="width:8%">
						<h:outputText value="#{indicadorArea.quantidade}"
							style="font-weight: bold;" />
					</rich:column>
					<rich:column style="width:8%">
						<h:outputText value="#{indicadorArea.media}"
							style="font-weight: bold;">
							<f:convertNumber maxFractionDigits="2" />
						</h:outputText>
					</rich:column>
					<rich:subTable rendered="#{indicadorArea.exibeIndicadores}"
						id="laboratoriosPorServicoRegiaoSubTable"
						rows="#{globalBean.defaultPageSize}"
						value="#{indicadorArea.indicadoresUF}" var="indicadorRegiao"
						rowKeyVar="indexRegiao" styleClass="fullWidthClass">
						<rich:column style="width:3%">
							<a4j:commandLink id="linkExibeIndicadoresServicoRegiao"
								action="#{indicadorLaboratorioRedeBean.exibeIndicadorServicoLaboratorio}"
								reRender="laboratoriosPorServicoTable, messages">
								<h:graphicImage value="/common/images/nolines_plus.gif"
									style="border: none"
									rendered="#{!indicadorRegiao.exibeIndicadores}" />
								<h:graphicImage value="/common/images/nolines_minus.gif"
									style="border: none"
									rendered="#{indicadorRegiao.exibeIndicadores}" />
								<a4j:actionparam name="indiceLabArea" value="${indexArea}"
									assignTo="#{indicadorLaboratorioRedeBean.indiceLabArea}" />
								<a4j:actionparam name="indiceLabServico" value="${indexServico}"
									assignTo="#{indicadorLaboratorioRedeBean.indiceLabServico}" />
								<a4j:actionparam name="indiceLabRegiao" value="${indexRegiao}"
									assignTo="#{indicadorLaboratorioRedeBean.indiceLabRegiao}" />
							</a4j:commandLink>
						</rich:column>
						<rich:column style="width:9%">
							<h:outputText />
						</rich:column>
						<rich:column style="width:24%">
							<h:outputText />
						</rich:column>
						<rich:column style="width:24%">
							<h:outputText value="#{indicadorRegiao.descricaoPessoa}"
								style="font-weight: bold;" />
						</rich:column>
						<rich:column style="width:24%">
							<h:outputText />
						</rich:column>
						<rich:column style="width:8%">
							<h:outputText value="#{indicadorRegiao.quantidade}"
								style="font-weight: bold;" />
						</rich:column>
						<rich:column style="width:8%">
							<h:outputText value="#{indicadorRegiao.media}"
								style="font-weight: bold;">
								<f:convertNumber maxFractionDigits="2" />
							</h:outputText>
						</rich:column>

						<rich:subTable rendered="#{indicadorRegiao.exibeIndicadores}"
							id="laboratoriosPorServicoRegiaoSubTable"
							rows="#{globalBean.defaultPageSize}"
							value="#{indicadorRegiao.indicadoresUF}" var="indicadorUF"
							rowKeyVar="index" styleClass="fullWidthClass">
							<rich:column style="width:3%">
							</rich:column>
							<rich:column style="width:9%">
								<h:outputText />
							</rich:column>
							<rich:column style="width:24%">
								<h:outputText />
							</rich:column>
							<rich:column style="width:24%">
								<h:outputText />
							</rich:column>
							<rich:column style="width:24%">
								<h:outputText value="#{indicadorUF.descricaoServicoMet}" />
							</rich:column>
							<rich:column style="width:8%">
								<h:outputText value="#{indicadorUF.quantidade}" />
							</rich:column>
							<rich:column style="width:8%">
								<h:outputText value="#{indicadorUF.media}">
									<f:convertNumber maxFractionDigits="2" />
								</h:outputText>
							</rich:column>
						</rich:subTable>
					</rich:subTable>
				</rich:subTable>

				<f:facet name="footer">
					<rich:columnGroup>
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column>
							<h:outputText value="#{indicadorLaboratorioRedeBean.vo.total}" />
						</rich:column>
						<rich:column>100</rich:column>
					</rich:columnGroup>
				</f:facet>
			</rich:dataTable>
			<h:outputText
				rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorServico.rowCount == 0}">
				<p class="note"><i><b>Resultado:</b> Nenhum dado encontrado
				que possibilite a geração do indicador por serviço para os termos de
				sua consulta. Por favor, tente novamente com outros dados no filtro.
				</i></p>
			</h:outputText>

			<rich:panel styleClass="panelInterno printlink"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorServico.wrappedData}">
				<h:panelGrid columns="2"
					columnClasses="noStyleClass, fullWidthClass">
					<a4j:commandButton id="imprimirServico" value="Imprimir"
						onclick="imprimir()" styleClass="buttonClass" />
					<h:commandButton id="excelServico" value="Exportar Excel"
						action="#{indicadorLaboratorioRedeBean.gerarRelatorioLaboratoriosServico}"
						styleClass="buttonClass" />
				</h:panelGrid>
			</rich:panel>
		</a4j:region>
	</rich:tab>

</ui:composition>
