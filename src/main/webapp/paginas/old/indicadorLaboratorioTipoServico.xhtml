<?xml version="1.0" encoding="ISO-8859-1"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
	<rich:tab name="Tipo Serviço"
		action="#{indicadorLaboratorioRedeBean.gerarIndicadorLaboratoriosTipoServico}"
		reRender="regiaoTipoServico">
		<f:facet name="label">
			<h:panelGroup>
				<h:outputText value="Tipo Serviço" />
			</h:panelGroup>
		</f:facet>
		<a4j:region id="regiaoTipoServico"
			rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorTipoServico != null}">
			<rich:dataTable id="laboratoriosPorTipoServicoTable"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorTipoServico.wrappedData}"
				rows="#{globalBean.defaultPageSize}"
				value="#{indicadorLaboratorioRedeBean.laboratoriosPorTipoServico}"
				var="laboratorioPorTipoServico" rowKeyVar="indexTipoServico"
				styleClass="fullWidthClass">
				<rich:column style="width:3%">
					<a4j:commandLink id="linkExibeIndicadoresTipoServico"
						action="#{indicadorLaboratorioRedeBean.exibeIndicadorTipoServico}"
						reRender="laboratoriosPorTipoServicoTable, messages">
						<h:graphicImage value="/common/images/nolines_plus.gif"
							style="border: none"
							rendered="#{!laboratorioPorTipoServico.exibeIndicadores}" />
						<h:graphicImage value="/common/images/nolines_minus.gif"
							style="border: none"
							rendered="#{laboratorioPorTipoServico.exibeIndicadores}" />
					</a4j:commandLink>
				</rich:column>
				<rich:column style="width:19%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Tipo Serviço" />
					</f:facet>
					<h:outputText
						value="#{laboratorioPorTipoServico.descricaoTipoServico}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:19%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Área Metrológica" />
					</f:facet>
				</rich:column>
				<rich:column style="width:19%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Região" />
					</f:facet>
				</rich:column>
				<rich:column style="width:19%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="UF" />
					</f:facet>
				</rich:column>
				<rich:column style="width:11%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Quantidade" />
					</f:facet>
					<h:outputText value="#{laboratorioPorTipoServico.quantidade}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:10%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="%" />
					</f:facet>
					<h:outputText value="#{laboratorioPorTipoServico.media}"
						style="font-weight: bold;">
						<f:convertNumber maxFractionDigits="2" />
					</h:outputText>
				</rich:column>
				<rich:subTable
					rendered="#{laboratorioPorTipoServico.exibeIndicadores}"
					id="laboratoriosPorTipoServicoAreaSubTable"
					rows="#{globalBean.defaultPageSize}"
					value="#{laboratorioPorTipoServico.indicadoresUF}"
					var="indicadorArea" rowKeyVar="indexArea"
					styleClass="fullWidthClass">
					<rich:column style="width:3%">
						<a4j:commandLink id="linkExibeIndicadoresTipoServicoArea"
							action="#{indicadorLaboratorioRedeBean.exibeIndicadorTipoServicoArea}"
							reRender="laboratoriosPorTipoServicoTable, messages">
							<h:graphicImage value="/common/images/nolines_plus.gif"
								style="border: none"
								rendered="#{!indicadorArea.exibeIndicadores}" />
							<h:graphicImage value="/common/images/nolines_minus.gif"
								style="border: none"
								rendered="#{indicadorArea.exibeIndicadores}" />
							<a4j:actionparam name="indiceLabArea" value="${indexArea}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabArea}" />
							<a4j:actionparam name="indiceLabTipoServico"
								value="${indexTipoServico}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabTipoServico}" />
						</a4j:commandLink>
					</rich:column>
					<rich:column style="width:19%">
					</rich:column>
					<rich:column style="width:19%">
						<h:outputText value="#{indicadorArea.descricaoArea}"
							style="font-weight: bold;" />
					</rich:column>
					<rich:column style="width:19%">
					</rich:column>
					<rich:column style="width:19%">
					</rich:column>
					<rich:column style="width:11%">
						<h:outputText value="#{indicadorArea.quantidade}"
							style="font-weight: bold;" />
					</rich:column>
					<rich:column style="width:10%">
						<h:outputText value="#{indicadorArea.media}"
							style="font-weight: bold;">
							<f:convertNumber maxFractionDigits="2" />
						</h:outputText>
					</rich:column>
					<rich:subTable rendered="#{indicadorArea.exibeIndicadores}"
						id="laboratoriosPorTipoServicoRegiaoSubTable"
						rows="#{globalBean.defaultPageSize}"
						value="#{indicadorArea.indicadoresUF}" var="indicadorRegiao"
						rowKeyVar="indexRegiao" styleClass="fullWidthClass">
						<rich:column style="width:3%">
							<a4j:commandLink id="linkExibeIndicadoresTipoServicoRegiao"
								action="#{indicadorLaboratorioRedeBean.exibeIndicadorTipoServicoAreaRegiao}"
								reRender="laboratoriosPorTipoServicoTable, messages">
								<h:graphicImage value="/common/images/nolines_plus.gif"
									style="border: none"
									rendered="#{!indicadorRegiao.exibeIndicadores}" />
								<h:graphicImage value="/common/images/nolines_minus.gif"
									style="border: none"
									rendered="#{indicadorRegiao.exibeIndicadores}" />
								<a4j:actionparam name="indiceLabArea" value="${indexArea}"
									assignTo="#{indicadorLaboratorioRedeBean.indiceLabArea}" />
								<a4j:actionparam name="indiceLabTipoServico"
									value="${indexTipoServico}"
									assignTo="#{indicadorLaboratorioRedeBean.indiceLabTipoServico}" />
								<a4j:actionparam name="indiceLabRegiao" value="${indexRegiao}"
									assignTo="#{indicadorLaboratorioRedeBean.indiceLabRegiao}" />
							</a4j:commandLink>
						</rich:column>
						<rich:column style="width:19%">
						</rich:column>
						<rich:column style="width:19%">
						</rich:column>
						<rich:column style="width:19%">
							<h:outputText value="#{indicadorRegiao.descricaoRegiao}"
								style="font-weight: bold;" />
						</rich:column>
						<rich:column style="width:19%">
						</rich:column>
						<rich:column style="width:11%">
							<h:outputText value="#{indicadorRegiao.quantidade}"
								style="font-weight: bold;" />
						</rich:column>
						<rich:column style="width:10%">
							<h:outputText value="#{indicadorRegiao.media}"
								style="font-weight: bold;">
								<f:convertNumber maxFractionDigits="2" />
							</h:outputText>
						</rich:column>

						<rich:subTable rendered="#{indicadorRegiao.exibeIndicadores}"
							id="laboratoriosPorTipoServicoRegiaoSubTable"
							rows="#{globalBean.defaultPageSize}"
							value="#{indicadorRegiao.indicadoresUF}" var="indicadorUF"
							rowKeyVar="index" styleClass="fullWidthClass">
							<rich:column style="width:3%">
							</rich:column>
							<rich:column style="width:19%">
							</rich:column>
							<rich:column style="width:19%">
							</rich:column>
							<rich:column style="width:19%">

							</rich:column>
							<rich:column style="width:19%">
								<h:outputText value="#{indicadorUF.uf}" />
							</rich:column>
							<rich:column style="width:11%">
								<h:outputText value="#{indicadorUF.quantidade}" />
							</rich:column>
							<rich:column style="width:10%">
								<h:outputText value="#{indicadorUF.media}">
									<f:convertNumber maxFractionDigits="2" />
								</h:outputText>
							</rich:column>
						</rich:subTable>
					</rich:subTable>
				</rich:subTable>

				<f:facet name="footer">
					<rich:columnGroup>
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column>
							<h:outputText value="#{indicadorLaboratorioRedeBean.vo.total}" />
						</rich:column>
						<rich:column>100</rich:column>
					</rich:columnGroup>
				</f:facet>
			</rich:dataTable>
			<h:outputText
				rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorTipoServico.rowCount == 0}">
				<p class="note"><i><b>Resultado:</b> Nenhum dado encontrado
				que possibilite a geração do indicador por tipo de serviço para os
				termos de sua consulta. Por favor, tente novamente com outros dados
				no filtro. </i></p>
			</h:outputText>

			<rich:panel styleClass="panelInterno printlink"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorTipoServico.wrappedData}">
				<h:panelGrid columns="2"
					columnClasses="noStyleClass, fullWidthClass">
					<a4j:commandButton id="imprimirTipoServico" value="Imprimir"
						onclick="imprimir()" styleClass="buttonClass" />
					<h:commandButton id="excelTipoServico" value="Exportar Excel"
						action="#{indicadorLaboratorioRedeBean.gerarRelatorioLaboratoriosTipoServico}"
						styleClass="buttonClass" />
				</h:panelGrid>
			</rich:panel>
		</a4j:region>
	</rich:tab>

</ui:composition>
