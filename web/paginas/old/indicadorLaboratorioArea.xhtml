<?xml version="1.0" encoding="ISO-8859-1"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
	<rich:tab name="Area"
		action="#{indicadorLaboratorioRedeBean.gerarIndicadorLaboratoriosArea}"
		reRender="regiaoArea">
		<f:facet name="label">
			<h:panelGroup>
				<h:outputText value="Área Metrológica" />
			</h:panelGroup>
		</f:facet>
		<a4j:region id="regiaoArea"
			rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorArea != null}">
			<rich:dataTable id="laboratoriosPorAreaTable"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorArea.wrappedData}"
				rows="#{globalBean.defaultPageSize}"
				value="#{indicadorLaboratorioRedeBean.laboratoriosPorArea}"
				var="laboratorioPorArea" rowKeyVar="indexArea"
				styleClass="fullWidthClass">
				<rich:column style="width:3%">
					<a4j:commandLink id="linkExibeIndicadores"
						action="#{indicadorLaboratorioRedeBean.exibeIndicadorArea}"
						reRender="laboratoriosPorAreaTable, messages">
						<h:graphicImage value="/common/images/nolines_plus.gif"
							style="border: none"
							rendered="#{!laboratorioPorArea.exibeIndicadores}" />
						<h:graphicImage value="/common/images/nolines_minus.gif"
							style="border: none"
							rendered="#{laboratorioPorArea.exibeIndicadores}" />
					</a4j:commandLink>
				</rich:column>
				<rich:column style="width:26%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Área Metrológica" />
					</f:facet>
					<h:outputText value="#{laboratorioPorArea.descricaoArea}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:22%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Região" />
					</f:facet>
				</rich:column>
				<rich:column style="width:22%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="UF" />
					</f:facet>
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Quantidade" />
					</f:facet>
					<h:outputText value="#{laboratorioPorArea.quantidade}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="%" />
					</f:facet>
					<h:outputText value="#{laboratorioPorArea.media}"
						style="font-weight: bold;">
						<f:convertNumber maxFractionDigits="2" />
					</h:outputText>
				</rich:column>
				<rich:subTable rendered="#{laboratorioPorArea.exibeIndicadores}"
					id="laboratoriosPorAreaSubTable"
					rows="#{globalBean.defaultPageSize}"
					value="#{laboratorioPorArea.indicadoresUF}" var="indicadorRegiao"
					rowKeyVar="indexRegiao" styleClass="fullWidthClass">
					<rich:column style="width:3%">
						<a4j:commandLink id="linkExibeIndicadoresArea"
							action="#{indicadorLaboratorioRedeBean.exibeIndicadorAreaRegiao}"
							reRender="laboratoriosPorAreaTable, messages">
							<h:graphicImage value="/common/images/nolines_plus.gif"
								style="border: none"
								rendered="#{!indicadorRegiao.exibeIndicadores}" />
							<h:graphicImage value="/common/images/nolines_minus.gif"
								style="border: none"
								rendered="#{indicadorRegiao.exibeIndicadores}" />
							<a4j:actionparam name="indiceLabArea" value="${indexArea}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabArea}" />
							<a4j:actionparam name="indiceLabRegiao" value="${indexRegiao}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabRegiao}" />
						</a4j:commandLink>
					</rich:column>
					<rich:column style="width:26%">
					</rich:column>
					<rich:column style="width:22%">
						<h:outputText value="#{indicadorRegiao.descricaoRegiao}"
							style="font-weight: bold;" />
					</rich:column>
					<rich:column style="width:22%">
					</rich:column>
					<rich:column style="width:15%">
						<h:outputText value="#{indicadorRegiao.quantidade}"
							style="font-weight: bold;" />
					</rich:column>
					<rich:column style="width:15%">
						<h:outputText value="#{indicadorRegiao.media}"
							style="font-weight: bold;">
							<f:convertNumber maxFractionDigits="2" />
						</h:outputText>
					</rich:column>
					<rich:subTable rendered="#{indicadorRegiao.exibeIndicadores}"
						id="laboratoriosPorAreaRegiaoSubTable"
						rows="#{globalBean.defaultPageSize}"
						value="#{indicadorRegiao.indicadoresUF}" var="indicadorUF"
						rowKeyVar="index" styleClass="fullWidthClass">
						<rich:column style="width:3%">
						</rich:column>
						<rich:column style="width:26%">
						</rich:column>
						<rich:column style="width:22%">
						</rich:column>
						<rich:column style="width:22%">
							<h:outputText value="#{indicadorUF.uf}" />
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorUF.quantidade}" />
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorUF.media}">
								<f:convertNumber maxFractionDigits="2" />
							</h:outputText>
						</rich:column>
					</rich:subTable>
				</rich:subTable>

				<f:facet name="footer">
					<rich:columnGroup>
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column>
							<h:outputText value="#{indicadorLaboratorioRedeBean.vo.total}" />
						</rich:column>
						<rich:column>100</rich:column>
					</rich:columnGroup>
				</f:facet>
			</rich:dataTable>
			<h:outputText
				rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorArea.rowCount == 0}">
				<p class="note"><i><b>Resultado:</b> Nenhum dado encontrado
				que possibilite a geração do indicador por área metrológica para os
				termos de sua consulta. Por favor, tente novamente com outros dados
				no filtro. </i></p>
			</h:outputText>

			<rich:panel styleClass="panelInterno printlink"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorArea.wrappedData}">
				<h:panelGrid columns="2"
					columnClasses="noStyleClass, fullWidthClass">
					<a4j:commandButton id="imprimirArea" value="Imprimir"
						onclick="imprimir()" styleClass="buttonClass" />
					<h:commandButton id="excelArea" value="Exportar Excel"
						action="#{indicadorLaboratorioRedeBean.gerarRelatorioLaboratoriosArea}"
						styleClass="buttonClass" />
				</h:panelGrid>
			</rich:panel>

		</a4j:region>
	</rich:tab>

</ui:composition>
