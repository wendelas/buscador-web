<?xml version="1.0" encoding="ISO-8859-1"?>

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
	<rich:tab name="Sustentabilidade"
		action="#{indicadorLaboratorioRedeBean.gerarIndicadorLaboratoriosSustentabilidade}"
		reRender="regiaoSust">
		<f:facet name="label">
			<h:panelGroup>
				<h:outputText value="Sustentabilidade" />
			</h:panelGroup>
		</f:facet>
		<a4j:region id="regiaoSust"
			rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorSustentabilidade != null}">
			<rich:dataTable id="laboratoriosPorSustentabilidadeTable"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorSustentabilidade.wrappedData}"
				rows="#{globalBean.defaultPageSize}"
				value="#{indicadorLaboratorioRedeBean.laboratoriosPorSustentabilidade}"
				var="laboratorioPorSust" rowKeyVar="indexSust"
				styleClass="fullWidthClass">
				<rich:column style="width:3%">
					<a4j:commandLink id="linkExibeIndicadores"
						action="#{indicadorLaboratorioRedeBean.exibeIndicadorSustentabilidade}"
						reRender="laboratoriosPorSustentabilidadeTable, messages">
						<h:graphicImage value="/common/images/nolines_plus.gif"
							style="border: none"
							rendered="#{!laboratorioPorSust.exibeIndicadores}" />
						<h:graphicImage value="/common/images/nolines_minus.gif"
							style="border: none"
							rendered="#{laboratorioPorSust.exibeIndicadores}" />
					</a4j:commandLink>
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Região" />
					</f:facet>
					<h:outputText value="#{laboratorioPorSust.descricaoRegiao}"
						style="font-weight: bold;" />
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="UF" />
					</f:facet>
				</rich:column>
				<rich:column style="width:22%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Laboratório" />
					</f:facet>
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Receitas" />
					</f:facet>
					<h:outputText value="#{laboratorioPorSust.valorReceitas}"
						style="font-weight: bold;">
						<f:convertNumber currencySymbol="R$" type="currency"
							maxFractionDigits="2" minFractionDigits="2" />
					</h:outputText>
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Despesas" />
					</f:facet>
					<h:outputText value="#{laboratorioPorSust.valorDespesas}"
						style="font-weight: bold;">
						<f:convertNumber currencySymbol="R$" type="currency"
							maxFractionDigits="2" minFractionDigits="2" />
					</h:outputText>
				</rich:column>
				<rich:column style="width:15%">
					<f:facet name="header">
						<h:outputText styleClass="headerText" value="Índice" />
					</f:facet>
					<h:outputText value="#{laboratorioPorSust.indice}"
						style="color:red;font-weight: bold;"
						rendered="#{laboratorioPorSust.indice le 1}">
						<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
					</h:outputText>
					<h:outputText value="#{laboratorioPorSust.indice}"
						style="font-weight: bold;"
						rendered="#{laboratorioPorSust.indice ge 1}">
						<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
					</h:outputText>
				</rich:column>
				<rich:subTable rendered="#{laboratorioPorSust.exibeIndicadores}"
					id="laboratoriosPorSustentabilidadeSubTable"
					rows="#{globalBean.defaultPageSize}"
					value="#{laboratorioPorSust.indicadoresUF}" var="indicadorRegiao"
					rowKeyVar="indexRegiao" styleClass="fullWidthClass">
					<rich:column style="width:3%">
						<a4j:commandLink id="linkExibeIndicadoresArea"
							action="#{indicadorLaboratorioRedeBean.exibeIndicadorSustentabilidadeUF}"
							reRender="laboratoriosPorSustentabilidadeTable, messages">
							<h:graphicImage value="/common/images/nolines_plus.gif"
								style="border: none"
								rendered="#{!indicadorRegiao.exibeIndicadores}" />
							<h:graphicImage value="/common/images/nolines_minus.gif"
								style="border: none"
								rendered="#{indicadorRegiao.exibeIndicadores}" />
							<a4j:actionparam name="indiceLabSust" value="${indexSust}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabSust}" />
							<a4j:actionparam name="indiceLabRegiao" value="${indexRegiao}"
								assignTo="#{indicadorLaboratorioRedeBean.indiceLabRegiao}" />
						</a4j:commandLink>
						<rich:column style="width:15%">
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText style="font-weight: bold;"
								value="#{indicadorRegiao.uf}" />
						</rich:column>
						<rich:column style="width:22%">
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorRegiao.valorReceitas}"
								style="font-weight: bold;">
								<f:convertNumber currencySymbol="R$" type="currency"
									maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorRegiao.valorDespesas}"
								style="font-weight: bold;">
								<f:convertNumber currencySymbol="R$" type="currency"
									maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorRegiao.indice}" style="color:red;font-weight: bold;"
								rendered="#{indicadorRegiao.indice le 1}">
								<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
							<h:outputText value="#{indicadorRegiao.indice}"
								style="font-weight: bold;"
								rendered="#{indicadorRegiao.indice ge 1}">
								<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
					</rich:column>
					<rich:subTable rendered="#{indicadorRegiao.exibeIndicadores}"
						id="laboratoriosPorSustentabilidadeRegiaoSubTable"
						rows="#{globalBean.defaultPageSize}"
						value="#{indicadorRegiao.indicadoresUF}" var="indicadorUF"
						rowKeyVar="index" styleClass="fullWidthClass">
						<rich:column style="width:3%">
						</rich:column>
						<rich:column style="width:15%">
						</rich:column>
						<rich:column style="width:15%">
						</rich:column>
						<rich:column style="width:22%">
							<h:outputText value="#{indicadorUF.nomeLaboratorio}" />
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorUF.valorReceitas}">
								<f:convertNumber currencySymbol="R$" type="currency"
									maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorUF.valorDespesas}">
								<f:convertNumber currencySymbol="R$" type="currency"
									maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
						<rich:column style="width:15%">
							<h:outputText value="#{indicadorUF.indice}" style="color:red"
								rendered="#{indicadorUF.indice le 1}">
								<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
							<h:outputText value="#{indicadorUF.indice}"
								rendered="#{indicadorUF.indice ge 1}">
								<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
					</rich:subTable>
				</rich:subTable>

				<f:facet name="footer">
					<rich:columnGroup>
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column />
						<rich:column>
							<h:outputText
								value="#{indicadorLaboratorioRedeBean.vo.valorReceitasTotal}">
								<f:convertNumber currencySymbol="R$" type="currency"
									maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
						<rich:column>
							<h:outputText
								value="#{indicadorLaboratorioRedeBean.vo.valorDespesasTotal}">
								<f:convertNumber currencySymbol="R$" type="currency"
									maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
						<rich:column>
							<h:outputText value="#{indicadorLaboratorioRedeBean.vo.indice}"
								style="color:red;font-weight: bold;"
								rendered="#{indicadorLaboratorioRedeBean.vo.indice le 1}">
								<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
							<h:outputText value="#{indicadorLaboratorioRedeBean.vo.indice}"
								style="font-weight: bold;"
								rendered="#{indicadorLaboratorioRedeBean.vo.indice ge 1}">
								<f:convertNumber maxFractionDigits="2" minFractionDigits="2" />
							</h:outputText>
						</rich:column>
					</rich:columnGroup>
				</f:facet>
			</rich:dataTable>
			<h:outputText
				rendered="#{indicadorLaboratorioRedeBean.laboratoriosPorSustentabilidade.rowCount == 0}">
				<p class="note"><i><b>Resultado:</b> Nenhum dado encontrado
				que possibilite a geração do indicador por sustentabilidade para os
				termos de sua consulta. Por favor, tente novamente com outros dados
				no filtro. </i></p>
			</h:outputText>

			<rich:panel styleClass="panelInterno printlink"
				rendered="#{not empty indicadorLaboratorioRedeBean.laboratoriosPorSustentabilidade.wrappedData}">
				<h:panelGrid columns="2"
					columnClasses="noStyleClass, fullWidthClass">
					<a4j:commandButton id="imprimirSust" value="Imprimir"
						onclick="imprimir()" styleClass="buttonClass" />
					<h:commandButton id="excelSust" value="Exportar Excel"
						action="#{indicadorLaboratorioRedeBean.gerarRelatorioLaboratoriosSustentabilidade}"
						styleClass="buttonClass" />
				</h:panelGrid>
			</rich:panel>

		</a4j:region>
	</rich:tab>

</ui:composition>
